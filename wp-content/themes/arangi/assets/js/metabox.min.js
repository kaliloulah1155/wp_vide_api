!function(t){"use strict";t(document).ready(function(){function e(){o.children("li").each(function(e){t(this).find("input:hidden").attr("name","sn-gallery-id["+e+"]")})}function a(){o.sortable({opacity:.6,stop:function(){e()}})}t(".format-type").hide(),t(".post-type-post #gallery_metabox").hide();t(".postbox input.post-format").attr("value");(t("#post-format-video").is(":checked")||t("#post-format-audio").is(":checked"))&&t(".post-type-video").show(),t("#post-format-quote").is(":checked")&&t(".post-type-quote").show(),t("#post-format-link").is(":checked")&&t(".post-type-link").show(),(t("#post-format-0").is(":checked")||t("#post-format-image").is(":checked")||t("#post-format-gallery").is(":checked"))&&t("#view-format-boxes").hide(),t("#post-format-gallery").is(":checked")&&t("#post #gallery_metabox").show(),t("input.post-format").change(function(){"video"==t(this).attr("value")||"audio"==t(this).attr("value")?t(".post-type-video").show():t(".post-type-video").hide(),"gallery"==t(this).attr("value")?t("#post #gallery_metabox").show():t("#post #gallery_metabox").hide(),"link"==t(this).attr("value")?t(".post-type-link").show():t(".post-type-link").hide(),"quote"==t(this).attr("value")?t(".post-type-quote").show():t(".post-type-quote").hide(),"image"==t(this).attr("value")||"0"==t(this).attr("value")||"gallery"==t(this).attr("value")?t("#view-format-boxes").hide():t("#view-format-boxes").show()});var i,o=t("#gallery-metabox ul.images-list").first();t(document).on("click","#gallery-metabox a.gallery-add-images",function(e){e.preventDefault(),i&&i.close(),(i=wp.media.frames.imgSelectFrame=wp.media({title:t(this).data("uploader-title"),button:{text:t(this).data("uploader-button-text")},multiple:!0})).on("select",function(){var t=o.children("li").index(o.children("li:last"));i.state().get("selection").map(function(e,a){e=e.toJSON();var i=t+(a+1),s=e.sizes.thumbnail;void 0==s&&(s=e.sizes.full),o.append('<li><input type="hidden" name="sn-gallery-id['+i+']" value="'+e.id+'"/><img class="image-preview" src="'+s.url+'"/><a class="change-image" href="#" data-uploader-title="Change image" data-uploader-button-text="Change image"><i class="dashicons dashicons-edit"></i></a><a class="remove-image" href="#"><i class="dashicons dashicons-no"></i></a></li>')})}),a(),i.open()}),t(document).on("click","#gallery-metabox a.change-image",function(e){e.preventDefault();var a=t(this);i&&i.close(),(i=wp.media.frames.imgSelectFrame=wp.media({title:t(this).data("uploader-title"),button:{text:t(this).data("uploader-button-text")},multiple:!1})).on("select",function(){var t=i.state().get("selection").first().toJSON(),e=t.sizes.thumbnail;void 0==e&&(e=t.sizes.full);var o=i.state().get("selection");console.log(o),a.closest("li").find("input:hidden").attr("value",t.id),a.closest("li").find("img.image-preview").attr("src",e.url)}),i.on("open",function(){var t=wp.media.attachment(a.closest("li").find("input:hidden").attr("value")),e=i.state().get("selection");e.add(t?[t]:[]),console.log(e)}),i.open()}),t(document).on("click","#gallery-metabox a.remove-image",function(a){a.preventDefault(),t(this).closest("li").animate({opacity:0},200,function(){t(this).remove(),e()})}),a()})}(jQuery);